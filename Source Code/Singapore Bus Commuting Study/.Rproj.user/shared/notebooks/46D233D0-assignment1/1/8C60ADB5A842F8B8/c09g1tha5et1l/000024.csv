"0","xy <- st_coordinates(singapore) "
"0",""
"0","x <- xy[,1]"
"0","y <- xy[,2]"
"0","pol <- xy[,5]"
"0",""
"0",""
"0","poly <- data.frame(pol,x,y)"
"0","x <- points[,1]"
"0","y <- points[,2]"
"0","object <- busStopLocation$BUS_STOP_N"
"0",""
"0","points <- data.frame(object,x,y)"
"0",""
"0",""
"0","library(mgcv)"
"0",""
"0","x <- split(poly$x, poly$pol)"
"0","y <- split(poly$y, poly$pol)"
"0",""
"0","todo <- 1:nrow(points)"
"0","Area <- rep.int("""", nrow(points))"
"0","pol <- names(x)"
"0",""
"0","# loop through polygons"
"0","for (i in 1:length(x)) {"
"0","  # the vertices of i-th polygon"
"0","  bnd <- cbind(x[[i]], y[[i]])"
"0","  # points to allocate"
"0","  xy <- with(points, cbind(x[todo], y[todo]))"
"0","  inbnd <- in.out(bnd, xy)"
"0","  # allocation"
"0","  Area[todo[inbnd]] <- pol[i]"
"0","  # update 'todo'"
"0","  todo <- todo[!inbnd]"
"0","  }"
"0",""
"0","points$Area <- Area"
"0",""
"0",""
