Intermediário_Adjacente <- bar_plot(dependent_variables,`Intermediário_Adjacente`)
Intermediário_Remoto <- bar_plot(dependent_variables,`Intermediário_Remoto`)
Rural_Adjacente <- bar_plot(dependent_variables,`Rural_Adjacente`)
Rural_Remoto <- bar_plot(dependent_variables,`Rural_Remoto`)
GVA_AGROPEC_Percentage <- plot_data(dependent_variables,"GVA_AGROPEC_Percentage")
GVA_INDUSTRY_Percentage <- plot_data(dependent_variables,"GVA_INDUSTRY_Percentage")
GVA_SERVICES_Percentage <- plot_data(dependent_variables,"GVA_SERVICES_Percentage")
GVA_PUBLIC_Percentage <- plot_data(dependent_variables,"GVA_PUBLIC_Percentage")
TAX_CAPITA <- plot_data(dependent_variables,"TAX_CAPITA")
COMP_AGRICULTURE <- plot_data(dependent_variables,"COMP_AGRICULTURE")
COMP_INDUSTRY <- plot_data(dependent_variables,"COMP_INDUSTRY")
COMP_SERVICES <- plot_data(dependent_variables,"COMP_SERVICES")
COMP_PUBLIC <- plot_data(dependent_variables,"COMP_PUBLIC")
MOTORCYCLE_RATIO <- plot_data(dependent_variables,"MOTORCYCLE_RATIO")
ggarrange(CAPITAL, IDHM, ALT, FOREIGNERS_PERCENTAGE,
DU_URBAN_PERCENTAGE, ACTIVE_PERCENTAGE, PLANTED_AREA_PERCENTAGE, Rural_Adjacente, Rural_Remoto, GVA_AGROPEC_Percentage, GVA_INDUSTRY_Percentage, GVA_SERVICES_Percentage,GVA_PUBLIC_Percentage,TAX_CAPITA,COMP_AGRICULTURE,COMP_INDUSTRY,COMP_SERVICES,COMP_PUBLIC,
MOTORCYCLE_RATIO,
ncol = 3,
nrow = 3)
class(data$CAPITAL)
class(unlist(data$CAPITAL))
class(unlist(data$CAPITAL), use.names=FALSE)
class(unlist(data$CAPITAL,use.names=FALSE))
plot_data <- function(maindata,attribute){
return(ggplot(data=maindata,
aes_string(x= attribute)) +
geom_histogram(bins=20,
color="black",
fill="light blue"))
}
bar_plot <- function(maindata,attribute){
data$attr <- as.data.frame(lapply(maindata, unlist))
return(ggplot(data=df2, aes(x = factor(unlist(attribute))))+
geom_bar(fill="light blue"))
}
plot_data <- function(maindata,attribute){
return(ggplot(data=maindata,
aes_string(x= attribute)) +
geom_histogram(bins=20,
color="black",
fill="light blue"))
}
bar_plot <- function(maindata,attribute){
return(ggplot(data=df2, aes(x = factor(unlist(attribute))))+
geom_bar(fill="light blue"))
}
CAPITAL <- bar_plot(dependent_variables,`CAPITAL`)
plot_data <- function(maindata,attribute){
return(ggplot(data=maindata,
aes_string(x= attribute)) +
geom_histogram(bins=20,
color="black",
fill="light blue"))
}
bar_plot <- function(maindata,attribute){
return(ggplot(data=maindata, aes(x = factor(unlist(attribute))))+
geom_bar(fill="light blue"))
}
CAPITAL <- bar_plot(dependent_variables,`CAPITAL`)
IDHM <- plot_data(dependent_variables,"IDHM")
ALT <- plot_data(dependent_variables,"ALT")
FOREIGNERS_PERCENTAGE <- plot_data(dependent_variables,"FOREIGNERS_PERCENTAGE")
DU_URBAN_PERCENTAGE <- plot_data(dependent_variables,"DU_URBAN_PERCENTAGE")
ACTIVE_PERCENTAGE <- plot_data(dependent_variables,"ACTIVE_PERCENTAGE")
PLANTED_AREA_PERCENTAGE <- plot_data(dependent_variables,"PLANTED_AREA_PERCENTAGE")
Intermediário_Adjacente <- bar_plot(dependent_variables,`Intermediário_Adjacente`)
Intermediário_Remoto <- bar_plot(dependent_variables,`Intermediário_Remoto`)
Rural_Adjacente <- bar_plot(dependent_variables,`Rural_Adjacente`)
Rural_Remoto <- bar_plot(dependent_variables,`Rural_Remoto`)
GVA_AGROPEC_Percentage <- plot_data(dependent_variables,"GVA_AGROPEC_Percentage")
GVA_INDUSTRY_Percentage <- plot_data(dependent_variables,"GVA_INDUSTRY_Percentage")
GVA_SERVICES_Percentage <- plot_data(dependent_variables,"GVA_SERVICES_Percentage")
GVA_PUBLIC_Percentage <- plot_data(dependent_variables,"GVA_PUBLIC_Percentage")
TAX_CAPITA <- plot_data(dependent_variables,"TAX_CAPITA")
COMP_AGRICULTURE <- plot_data(dependent_variables,"COMP_AGRICULTURE")
COMP_INDUSTRY <- plot_data(dependent_variables,"COMP_INDUSTRY")
COMP_SERVICES <- plot_data(dependent_variables,"COMP_SERVICES")
COMP_PUBLIC <- plot_data(dependent_variables,"COMP_PUBLIC")
MOTORCYCLE_RATIO <- plot_data(dependent_variables,"MOTORCYCLE_RATIO")
ggarrange(CAPITAL, IDHM, ALT, FOREIGNERS_PERCENTAGE,
DU_URBAN_PERCENTAGE, ACTIVE_PERCENTAGE, PLANTED_AREA_PERCENTAGE, Rural_Adjacente, Rural_Remoto, GVA_AGROPEC_Percentage, GVA_INDUSTRY_Percentage, GVA_SERVICES_Percentage,GVA_PUBLIC_Percentage,TAX_CAPITA,COMP_AGRICULTURE,COMP_INDUSTRY,COMP_SERVICES,COMP_PUBLIC,
MOTORCYCLE_RATIO,
ncol = 3,
nrow = 3)
plot_data <- function(maindata,attribute){
return(ggplot(data=maindata,
aes_string(x= attribute)) +
geom_histogram(bins=20,
color="black",
fill="light blue"))
}
bar_plot <- function(maindata,attribute){
return(ggplot(data=maindata, aes_string(x=attribute))+
geom_bar(fill="light blue"))
}
CAPITAL <- bar_plot(dependent_variables,"CAPITAL")
IDHM <- plot_data(dependent_variables,"IDHM")
ALT <- plot_data(dependent_variables,"ALT")
FOREIGNERS_PERCENTAGE <- plot_data(dependent_variables,"FOREIGNERS_PERCENTAGE")
DU_URBAN_PERCENTAGE <- plot_data(dependent_variables,"DU_URBAN_PERCENTAGE")
ACTIVE_PERCENTAGE <- plot_data(dependent_variables,"ACTIVE_PERCENTAGE")
PLANTED_AREA_PERCENTAGE <- plot_data(dependent_variables,"PLANTED_AREA_PERCENTAGE")
Intermediário_Adjacente <- bar_plot(dependent_variables,"Intermediário_Adjacente")
Intermediário_Remoto <- bar_plot(dependent_variables,"Intermediário_Remoto")
Rural_Adjacente <- bar_plot(dependent_variables,"Rural_Adjacente")
Rural_Remoto <- bar_plot(dependent_variables,"Rural_Remoto")
GVA_AGROPEC_Percentage <- plot_data(dependent_variables,"GVA_AGROPEC_Percentage")
GVA_INDUSTRY_Percentage <- plot_data(dependent_variables,"GVA_INDUSTRY_Percentage")
GVA_SERVICES_Percentage <- plot_data(dependent_variables,"GVA_SERVICES_Percentage")
GVA_PUBLIC_Percentage <- plot_data(dependent_variables,"GVA_PUBLIC_Percentage")
TAX_CAPITA <- plot_data(dependent_variables,"TAX_CAPITA")
COMP_AGRICULTURE <- plot_data(dependent_variables,"COMP_AGRICULTURE")
COMP_INDUSTRY <- plot_data(dependent_variables,"COMP_INDUSTRY")
COMP_SERVICES <- plot_data(dependent_variables,"COMP_SERVICES")
COMP_PUBLIC <- plot_data(dependent_variables,"COMP_PUBLIC")
MOTORCYCLE_RATIO <- plot_data(dependent_variables,"MOTORCYCLE_RATIO")
ggarrange(CAPITAL, IDHM, ALT, FOREIGNERS_PERCENTAGE,
DU_URBAN_PERCENTAGE, ACTIVE_PERCENTAGE, PLANTED_AREA_PERCENTAGE, Urbano, Rural_Adjacente, Rural_Remoto, GVA_AGROPEC_Percentage, GVA_INDUSTRY_Percentage, GVA_SERVICES_Percentage,GVA_PUBLIC_Percentage,TAX_CAPITA,COMP_AGRICULTURE,COMP_INDUSTRY,COMP_SERVICES,COMP_PUBLIC,
MOTORCYCLE_RATIO,
ncol = 3,
nrow = 3)
CAPITAL <- bar_plot(dependent_variables,"CAPITAL")
IDHM <- plot_data(dependent_variables,"IDHM")
ALT <- plot_data(dependent_variables,"ALT")
FOREIGNERS_PERCENTAGE <- plot_data(dependent_variables,"FOREIGNERS_PERCENTAGE")
DU_URBAN_PERCENTAGE <- plot_data(dependent_variables,"DU_URBAN_PERCENTAGE")
ACTIVE_PERCENTAGE <- plot_data(dependent_variables,"ACTIVE_PERCENTAGE")
PLANTED_AREA_PERCENTAGE <- plot_data(dependent_variables,"PLANTED_AREA_PERCENTAGE")
Intermediário_Adjacente <- bar_plot(dependent_variables,"Intermediário_Adjacente")
Intermediário_Remoto <- bar_plot(dependent_variables,"Intermediário_Remoto")
Rural_Adjacente <- bar_plot(dependent_variables,"Rural_Adjacente")
Rural_Remoto <- bar_plot(dependent_variables,"Rural_Remoto")
GVA_AGROPEC_Percentage <- plot_data(dependent_variables,"GVA_AGROPEC_Percentage")
GVA_INDUSTRY_Percentage <- plot_data(dependent_variables,"GVA_INDUSTRY_Percentage")
GVA_SERVICES_Percentage <- plot_data(dependent_variables,"GVA_SERVICES_Percentage")
GVA_PUBLIC_Percentage <- plot_data(dependent_variables,"GVA_PUBLIC_Percentage")
TAX_CAPITA <- plot_data(dependent_variables,"TAX_CAPITA")
COMP_AGRICULTURE <- plot_data(dependent_variables,"COMP_AGRICULTURE")
COMP_INDUSTRY <- plot_data(dependent_variables,"COMP_INDUSTRY")
COMP_SERVICES <- plot_data(dependent_variables,"COMP_SERVICES")
COMP_PUBLIC <- plot_data(dependent_variables,"COMP_PUBLIC")
MOTORCYCLE_RATIO <- plot_data(dependent_variables,"MOTORCYCLE_RATIO")
ggarrange(CAPITAL, IDHM, ALT, FOREIGNERS_PERCENTAGE,
DU_URBAN_PERCENTAGE, ACTIVE_PERCENTAGE, PLANTED_AREA_PERCENTAGE, Intermediário_Remoto, Rural_Adjacente, Rural_Remoto, GVA_AGROPEC_Percentage, GVA_INDUSTRY_Percentage,GVA_SERVICES_Percentage,GVA_PUBLIC_Percentage,TAX_CAPITA,COMP_AGRICULTURE,COMP_INDUSTRY,COMP_SERVICES,COMP_PUBLIC,
MOTORCYCLE_RATIO,
ncol = 3,
nrow = 3)
gdp_capita.lmr <- lm(formula = GDP_CAPITA ~ CAPITAL + IDHM + ALT+ FOREIGNERS_PERCENTAGE +
DU_URBAN_PERCENTAGE + ACTIVE_PERCENTAGE + PLANTED_AREA_PERCENTAGE + Intermediário_Adjacente+ Intermediário_Remoto+ Rural_Adjacente + Rural_Remoto + GVA_AGROPEC_Percentage+ GVA_INDUSTRY_Percentage + GVA_SERVICES_Percentage + GVA_PUBLIC_Percentage + TAX_CAPITA + COMP_AGRICULTURE + COMP_INDUSTRY + COMP_SERVICES + COMP_PUBLIC + MOTORCYCLE_RATIO, data = dependent_variables)
summary(gdp_capita.lmr)
gdp_capita.lmr <- lm(formula = GDP_CAPITA.log ~ CAPITAL + IDHM + ALT+ FOREIGNERS_PERCENTAGE +
DU_URBAN_PERCENTAGE + ACTIVE_PERCENTAGE + PLANTED_AREA_PERCENTAGE + Intermediário_Adjacente+ Intermediário_Remoto+ Rural_Adjacente + Rural_Remoto + GVA_AGROPEC_Percentage+ GVA_INDUSTRY_Percentage + GVA_SERVICES_Percentage + GVA_PUBLIC_Percentage + TAX_CAPITA + COMP_AGRICULTURE + COMP_INDUSTRY + COMP_SERVICES + COMP_PUBLIC + MOTORCYCLE_RATIO, data = dependent_variables)
summary(gdp_capita.lmr)
gdp_capita.lmr <- lm(formula = GDP_CAPITA.log ~   IDHM +
DU_URBAN_PERCENTAGE + ACTIVE_PERCENTAGE + PLANTED_AREA_PERCENTAGE + Intermediário_Adjacente+ Intermediário_Remoto+ Rural_Adjacente + Rural_Remoto + GVA_AGROPEC_Percentage+ GVA_INDUSTRY_Percentage + GVA_SERVICES_Percentage + GVA_PUBLIC_Percentage + TAX_CAPITA + COMP_AGRICULTURE + COMP_INDUSTRY + COMP_SERVICES + COMP_PUBLIC , data = dependent_variables)
summary(gdp_capita.lmr)
ols_plot_obs_fit(gdp_capita.lmr, print_plot = TRUE)
ols_plot_resid_fit(gdp_capita.lmr, print_plot = TRUE)
ols_vif_tol(gdp_capita.lmr)
ols_plot_resid_hist(gdp_capita.lmr)
ks.test(x=gdp_capita.lmr$residuals,y="pnorm",alternative='two.sided')
# Density plot
ggdensity(gdp_capita.lmr$residuals, fill = "lightgray")
# QQ plot
ggqqplot(gdp_capita.lmr$residuals)
# Density plot
ggdensity(gdp_capita.lmr$residuals, fill = "lightgray")
# QQ plot
ggqqplot(gdp_capita.lmr$residuals)
data$residuals <- gdp_capita.lmr$residuals
data.sp <- as_Spatial(data)
data.sp
tm_shape(data)+
tm_polygons("residuals", border.col = "black",border.alpha = 0.2)
coords <- coordinates(data.sp)
k1 <- knn2nb(knearneigh(coords))
k1dists <- unlist(nbdists(k1,coords,longlat = TRUE))
summary(k1dists)
nb <- dnearneigh(coordinates(data.sp), 0, 370, longlat = TRUE)
summary(nb)
nb_lw <- nb2listw(nb, style = 'W')
summary(nb_lw)
lm.morantest(gdp_capita.lmr, nb_lw)
ols_test_bartlett(gdp_capita.lmr)
ols_test_breusch_pagan(gdp_capita.lmr)
ols_test_breusch_pagan(gdp_capita.lmr$residuals)
ols_test_breusch_pagan(gdp_capita.lmr)
attributes(gdp_capita.lmr)
gdp_capita.lmr$coefficients
bw.fixed <- bw.gwr(formula = GDP_CAPITA.log ~ IDHM  +
DU_URBAN_PERCENTAGE + ACTIVE_PERCENTAGE + PLANTED_AREA_PERCENTAGE + Intermediário_Adjacente+ Intermediário_Remoto+ Rural_Adjacente + GVA_AGROPEC_Percentage+ GVA_INDUSTRY_Percentage + GVA_SERVICES_Percentage + Rural_Remoto+ GVA_PUBLIC_Percentage + TAX_CAPITA + COMP_AGRICULTURE + COMP_INDUSTRY + COMP_SERVICES + COMP_PUBLIC , data = data.sp, approach = "CV", kernel="gaussian", adaptive=FALSE, longlat=TRUE)
bw.fixed <- bw.gwr(formula = GDP_CAPITA.log ~ IDHM  +
DU_URBAN_PERCENTAGE + ACTIVE_PERCENTAGE + PLANTED_AREA_PERCENTAGE + Intermediário_Adjacente+ Rural_Adjacente + GVA_AGROPEC_Percentage+ GVA_INDUSTRY_Percentage + GVA_SERVICES_Percentage + Rural_Remoto+ GVA_PUBLIC_Percentage + TAX_CAPITA + COMP_AGRICULTURE + COMP_INDUSTRY + COMP_SERVICES + COMP_PUBLIC , data = data.sp, approach = "CV", kernel="gaussian", adaptive=FALSE, longlat=TRUE)
gwr.fixed <- gwr.basic(formula = GDP_CAPITA ~ IDHM  + DU_URBAN_PERCENTAGE + ACTIVE_PERCENTAGE + PLANTED_AREA_PERCENTAGE + Intermediário_Adjacente+ + Rural_Adjacente + GVA_AGROPEC_Percentage+ GVA_INDUSTRY_Percentage + GVA_SERVICES_Percentage + Rural_Remoto+ GVA_PUBLIC_Percentage + TAX_CAPITA + COMP_AGRICULTURE + COMP_INDUSTRY + COMP_SERVICES + CAR_RATIO, data = data.sp, bw = bw.fixed*10, kernel = 'gaussian', longlat = TRUE)
gwr.fixed <- gwr.basic(formula = GDP_CAPITA.log ~ IDHM  + DU_URBAN_PERCENTAGE + ACTIVE_PERCENTAGE + PLANTED_AREA_PERCENTAGE + Intermediário_Adjacente+ Rural_Adjacente + GVA_AGROPEC_Percentage+ GVA_INDUSTRY_Percentage + GVA_SERVICES_Percentage + Rural_Remoto+ GVA_PUBLIC_Percentage + TAX_CAPITA + COMP_AGRICULTURE + COMP_INDUSTRY + COMP_SERVICES + COMP_PUBLIC , data = data.sp, bw = bw.fixed*10, kernel = 'gaussian', longlat = TRUE)
gwr.fixed
gdp_capita.lmr$rank
gdp_capita.lmr$coefficients
gdp_capita.lmr$coefficients
coefficients <- as.data.frame(gdp_capita.lmr$coefficients)
coefficients
coefficients <- as.data.frame(gdp_capita.lmr$coefficients)
coefficients[order(coefficients$`gdp_capita.lmr$coefficients`)]
coefficients <- as.data.frame(gdp_capita.lmr$coefficients)
coefficients
names(coefficients)
coefficients <- as.data.frame(gdp_capita.lmr$coefficients)
coefficients <- coefficients %>% rename("value"<-gdp_capita.lmr$coefficients)
coefficients <- as.data.frame(gdp_capita.lmr$coefficients)
coefficients <- coefficients %>% rename("value"<-`gdp_capita.lmr$coefficients`)
coefficients <- as.data.frame(gdp_capita.lmr$coefficients, col.names=c("Value"))
coefficients
coefficients <- as.data.frame(table(gdp_capita.lmr$coefficients, dnn=c("Value")))
coefficients
coefficients <- as.data.frame(table(gdp_capita.lmr$coefficients, responseName=c("Value")))
coefficients <- as.data.frame(table(gdp_capita.lmr$coefficients, responseName=c("Value")))
gdp_capita.lmr$coefficients
coefficients <- as.data.frame(gdp_capita.lmr$coefficients)
coefficients
coefficients <- as.data.frame(gdp_capita.lmr$coefficients)
colnames(coefficients) <- c("Value")
coefficients
coefficients <- as.data.frame(gdp_capita.lmr$coefficients)
colnames(coefficients) <- c("Value")
coefficients[order(coefficients$Value)]
coefficients <- as.data.frame(gdp_capita.lmr$coefficients)
colnames(coefficients) <- c("Value")
coefficients[order(Value),]
names(coefficients)
coefficients <- as.data.frame(gdp_capita.lmr$coefficients)
colnames(coefficients) <- c("Value")
coefficients[with(coefficients, order(Value)),]
coefficients <- as.data.frame(gdp_capita.lmr$coefficients)
colnames(coefficients) <- c("Value")
coefficients[with(coefficients, order(Value))]
coefficients <- as.data.frame(gdp_capita.lmr$coefficients)
colnames(coefficients) <- c("Value")
coefficients[with(coefficients, order(Value)),]
View(coefficients)
coefficients <- as.data.frame(gdp_capita.lmr$coefficients)
colnames(coefficients) <- c("Value")
sorted <- coefficients[with(coefficients, order(Value)),]
sorted
coefficients <- as.data.frame(gdp_capita.lmr$coefficients)
colnames(coefficients) <- c("Value")
sorted <- coefficients[with(coefficients, order(Value)),]
print(sorted)
View(coefficients)
coefficients <- as.data.frame(gdp_capita.lmr$coefficients)
colnames(coefficients) <- c("Value")
sorted <- coefficients[with(coefficients, order(Value)),]
sorted$Variable <- rownames(sorted)
print(sorted)
View(sorted)
coefficients <- as.data.frame(gdp_capita.lmr$coefficients)
print(coefficients)
View(coefficients)
coefficients <- as.data.frame(gdp_capita.lmr$coefficients)
colnames(coefficients) <- c("Value")
print(coefficients)
View(coefficients)
coefficients$Value <- coefficients$Value *1000
coefficients
coefficients <- as.data.frame(gdp_capita.lmr$coefficients)
colnames(coefficients) <- c("Value")
print(coefficients)
coefficients$Value <- coefficients$Value *100
coefficients
coefficients <- as.data.frame(gdp_capita.lmr$coefficients)
colnames(coefficients) <- c("Value")
print(coefficients)
coefficients$Value <- coefficients$Value *1000
coefficients
View(coefficients)
2.611680e+02
gwr.fixed <- gwr.basic(formula = GDP_CAPITA.log ~ IDHM  + DU_URBAN_PERCENTAGE + ACTIVE_PERCENTAGE + PLANTED_AREA_PERCENTAGE + Intermediário_Adjacente+ Rural_Adjacente + GVA_AGROPEC_Percentage+ GVA_INDUSTRY_Percentage + GVA_SERVICES_Percentage + Rural_Remoto+ GVA_PUBLIC_Percentage + TAX_CAPITA + COMP_AGRICULTURE + COMP_INDUSTRY + COMP_SERVICES + COMP_PUBLIC , data = data.sp, bw = bw.fixed*10, kernel = 'gaussian', longlat = TRUE)
gwr.fixed
gdp_capita.fixed <- st_as_sf(gwr.fixed$SDF) %>%
st_transform(crs=4674)
tm_shape(gdp_capita.fixed)+
tm_polygons("Local_R2",border.col = "black", border.alpha = 0.2)
tm_shape(gdp_capita.fixed)+
tm_polygons("Intercept",border.col = "black", border.alpha = 0.2)
tm_shape(gdp_capita.fixed)+
tm_polygons("IDHM",border.col = "black", border.alpha = 0.2)+
tm_lines("IDHM_TV", breaks = c(-Inf,-1.96,1.96,Inf))
tm_shape(gdp_capita.fixed)+
tm_polygons("IDHM",border.col = "black", border.alpha = 0.2)+
tm_shape(gdp_capita.fixed)+
tm_lines("IDHM_TV", breaks = c(-Inf,-1.96,1.96,Inf))
tm_shape(gdp_capita.fixed)+
tm_polygons("IDHM",border.col = "black", border.alpha = 0.2)+
tm_shape(gdp_capita.fixed)+
tm_lines("red")
makeMap <- function(variable,tscore){
one <- tm_shape(gdp_capita.fixed)+
tm_polygons(variable,border.col = "black", border.alpha = 0.2)
two <- tm_shape(gdp_capita.fixed)+
tm_polygons(tscore,border.col = "black", border.alpha = 0.2, breaks=c(-Inf,-1.96,1.96,Inf))
return(tmap_arrange(one,two,ncol=2,nrow = 1))
}
IDHM <- makeMap("IDHM","IDHM_TV")
DU_URBAN_PERCENTAGE <- makeMap("DU_URBAN_PERCENTAGE","DU_URBAN_PERCENTAGE_TV")
ACTIVE_PERCENTAGE <- makeMap("ACTIVE_PERCENTAGE","ACTIVE_PERCENTAGE_TV")
PLANTED_AREA_PERCENTAGE <- makeMap("PLANTED_AREA_PERCENTAGE","PLANTED_AREA_PERCENTAGE_TV")
Intermediário_Adjacente <- makeMap("Intermediário_Adjacente","Intermediário_Adjacente_TV")
Urbano <- makeMap("Urbano","Urbano_TV")
Rural_Adjacente <- makeMap("Rural_Adjacente","Rural_Adjacente_TV")
GVA_AGROPEC_Percentage <- makeMap("GVA_AGROPEC_Percentage","GVA_AGROPEC_Percentage_TV")
GVA_INDUSTRY_Percentage <- makeMap("GVA_INDUSTRY_Percentage","GVA_INDUSTRY_Percentage_TV")
GVA_SERVICES_Percentage <- makeMap("GVA_SERVICES_Percentage","GVA_SERVICES_Percentage_TV")
Rural_Remoto <- makeMap("Rural_Remoto","Rural_Remoto_TV")
GVA_PUBLIC_Percentage <- makeMap("GVA_PUBLIC_Percentage","GVA_PUBLIC_Percentage_TV")
TAX_CAPITA <- makeMap("TAX_CAPITA","TAX_CAPITA_TV")
COMP_AGRICULTURE <- makeMap("COMP_AGRICULTURE","COMP_AGRICULTURE_TV")
COMP_INDUSTRY <- makeMap("COMP_INDUSTRY","COMP_INDUSTRY_TV")
COMP_SERVICES <- makeMap("COMP_SERVICES","COMP_SERVICES_TV")
CAR_RATIO <- makeMap("CAR_RATIO","CAR_RATIO_TV")
IDHM
DU_URBAN_PERCENTAGE
ACTIVE_PERCENTAGE
PLANTED_AREA_PERCENTAGE
one <- tm_shape(gdp_capita.fixed)+
tm_polygons("Local_R2",border.col = "black", border.alpha = 0.2)
two <- tm_shape(data)+
tm_polygons("GDP_CAPITA",border.col = "black", border.alpha = 0.2)
tmap_arrange(one,two,ncol = 2,nrow = 1)
one <- tm_shape(gdp_capita.fixed)+
tm_polygons("Local_R2",border.col = "black", border.alpha = 0.2)
two <- tm_shape(data)+
tm_polygons("GDP_CAPITA",border.col = "black", border.alpha = 0.2, style="quantile")
tmap_arrange(one,two,ncol = 2,nrow = 1)
View(gwr.fixed)
View(gdp_capita.fixed)
one <- tm_shape(gdp_capita.fixed)+
tm_polygons("yhat",border.col = "black", border.alpha = 0.2)
two <- tm_shape(data)+
tm_polygons("GDP_CAPITA",border.col = "black", border.alpha = 0.2, style="quintile")
tmap_arrange(one,two,ncol = 2,nrow = 1)
tm_shape(gdp_capita.fixed)+
tm_polygons("yhat",border.col = "black", border.alpha = 0.2)
tm_shape(data)+
tm_polygons("GDP_CAPITA",border.col = "black", border.alpha = 0.2, style="quintile")
tm_shape(gdp_capita.fixed)+
tm_polygons("yhat",border.col = "black", border.alpha = 0.2)
tm_shape(data)+
tm_polygons("GDP_CAPITA",border.col = "black", border.alpha = 0.2, style="quintile")
tm_shape(data)+
tm_polygons("GDP_CAPITA",border.col = "black", border.alpha = 0.2, style="quintile")
one <- tm_shape(gdp_capita.fixed)+
tm_polygons("yhat",border.col = "black", border.alpha = 0.2)
two <- tm_shape(data)+
tm_polygons("GDP_CAPITA",border.col = "black", border.alpha = 0.2, style="quartile")
tmap_arrange(one,two,ncol = 2,nrow = 1)
one <- tm_shape(gdp_capita.fixed)+
tm_polygons("yhat",border.col = "black", border.alpha = 0.2)
two <- tm_shape(data)+
tm_polygons("GDP_CAPITA",border.col = "black", border.alpha = 0.2, style="quantile")
tmap_arrange(one,two,ncol = 2,nrow = 1)
View(gdp_capita.fixed)
one <- tm_shape(gdp_capita.fixed)+
tm_polygons("yhat",border.col = "black", border.alpha = 0.2)
two <- tm_shape(data)+
tm_polygons("GDP_CAPITA.log",border.col = "black", border.alpha = 0.2, style="quantile")
tmap_arrange(one,two,ncol = 2,nrow = 1)
one <- tm_shape(gdp_capita.fixed)+
tm_polygons("yhat",border.col = "black", border.alpha = 0.2, style="quantile")
two <- tm_shape(data)+
tm_polygons("GDP_CAPITA.log",border.col = "black", border.alpha = 0.2, style="quantile")
tmap_arrange(one,two,ncol = 2,nrow = 1)
abs(-10)
abs(c(-10,-11))
gdp_capita.fixed <- gdp_capita.fixed %>%
mutate(IDHM_TV=abs(IDHM_TV)) %>%
mutate(DU_URBAN_PERCENTAGE_TV=abs(DU_URBAN_PERCENTAGE_TV)) %>%
mutate(ACTIVE_PERCENTAGE_TV=abs(ACTIVE_PERCENTAGE_TV)) %>%
mutate(PLANTED_AREA_PERCENTAGE_TV=abs(PLANTED_AREA_PERCENTAGE_TV)) %>%
mutate(Intermediário_Adjacente=abs(Intermediário_Adjacente_TV)) %>%
mutate(Rural_Adjacente=abs(Rural_Adjacente_TV)) %>%
mutate(GVA_AGROPEC_Percentage=abs(GVA_AGROPEC_Percentage_TV)) %>%
mutate(GVA_SERVICES_Percentage=abs(GVA_SERVICES_Percentage_TV)) %>%
mutate(Rural_Remoto_TV=abs(Rural_Remoto_TV)) %>%
mutate(GVA_PUBLIC_Percentage_TV=abs(GVA_PUBLIC_Percentage_TV)) %>%
mutate(TAX_CAPITA_TV=abs(TAX_CAPITA_TV)) %>%
mutate(COMP_AGRICULTURE_TV=abs(COMP_AGRICULTURE_TV)) %>%
mutate(COMP_INDUSTRY_TV=abs(COMP_INDUSTRY_TV)) %>%
mutate(COMP_SERVICES_TV=abs(COMP_SERVICES_TV)) %>%
mutate(CAR_RATIO_TV=abs(CAR_RATIO_TV))
gdp_capita.fixed <- gdp_capita.fixed %>%
mutate(IDHM_TV=abs(IDHM_TV)) %>%
mutate(DU_URBAN_PERCENTAGE_TV=abs(DU_URBAN_PERCENTAGE_TV)) %>%
mutate(ACTIVE_PERCENTAGE_TV=abs(ACTIVE_PERCENTAGE_TV)) %>%
mutate(PLANTED_AREA_PERCENTAGE_TV=abs(PLANTED_AREA_PERCENTAGE_TV)) %>%
mutate(Intermediário_Adjacente=abs(Intermediário_Adjacente_TV)) %>%
mutate(Rural_Adjacente=abs(Rural_Adjacente_TV)) %>%
mutate(GVA_AGROPEC_Percentage=abs(GVA_AGROPEC_Percentage_TV)) %>%
mutate(GVA_SERVICES_Percentage=abs(GVA_SERVICES_Percentage_TV)) %>%
mutate(Rural_Remoto_TV=abs(Rural_Remoto_TV)) %>%
mutate(GVA_PUBLIC_Percentage_TV=abs(GVA_PUBLIC_Percentage_TV)) %>%
mutate(TAX_CAPITA_TV=abs(TAX_CAPITA_TV)) %>%
mutate(COMP_AGRICULTURE_TV=abs(COMP_AGRICULTURE_TV)) %>%
mutate(COMP_INDUSTRY_TV=abs(COMP_INDUSTRY_TV)) %>%
mutate(COMP_SERVICES_TV=abs(COMP_SERVICES_TV))
makeMap <- function(variable,tscore){
one <- tm_shape(gdp_capita.fixed)+
tm_polygons(variable,border.col = "black", border.alpha = 0.2)
two <- tm_shape(gdp_capita.fixed)+
tm_polygons(tscore,border.col = "black", border.alpha = 0.2, breaks=c(-Inf,-1.96,1.96,Inf))
return(tmap_arrange(one,two,ncol=2,nrow = 1))
}
IDHM <- makeMap("IDHM","IDHM_TV")
DU_URBAN_PERCENTAGE <- makeMap("DU_URBAN_PERCENTAGE","DU_URBAN_PERCENTAGE_TV")
ACTIVE_PERCENTAGE <- makeMap("ACTIVE_PERCENTAGE","ACTIVE_PERCENTAGE_TV")
PLANTED_AREA_PERCENTAGE <- makeMap("PLANTED_AREA_PERCENTAGE","PLANTED_AREA_PERCENTAGE_TV")
Intermediário_Adjacente <- makeMap("Intermediário_Adjacente","Intermediário_Adjacente_TV")
Rural_Adjacente <- makeMap("Rural_Adjacente","Rural_Adjacente_TV")
GVA_AGROPEC_Percentage <- makeMap("GVA_AGROPEC_Percentage","GVA_AGROPEC_Percentage_TV")
GVA_INDUSTRY_Percentage <- makeMap("GVA_AGROPEC_Percentage","GVA_INDUSTRY_Percentage_TV")
GVA_SERVICES_Percentage <- makeMap("GVA_SERVICES_Percentage","GVA_SERVICES_Percentage_TV")
Rural_Remoto <- makeMap("Rural_Remoto","Rural_Remoto_TV")
GVA_PUBLIC_Percentage <- makeMap("GVA_PUBLIC_Percentage","GVA_PUBLIC_Percentage_TV")
TAX_CAPITA <- makeMap("TAX_CAPITA","TAX_CAPITA_TV")
COMP_AGRICULTURE <- makeMap("COMP_AGRICULTURE","COMP_AGRICULTURE_TV")
COMP_INDUSTRY <- makeMap("COMP_INDUSTRY","COMP_INDUSTRY_TV")
COMP_SERVICES <- makeMap("COMP_SERVICES","COMP_SERVICES_TV")
IDHM
DU_URBAN_PERCENTAGE
ACTIVE_PERCENTAGE
PLANTED_AREA_PERCENTAGE
makeMap <- function(variable,tscore){
one <- tm_shape(gdp_capita.fixed)+
tm_polygons(variable,border.col = "black", border.alpha = 0.2)
two <- tm_shape(gdp_capita.fixed)+
tm_polygons(tscore,border.col = "black", border.alpha = 0.2, breaks=c(0,1.96,Inf))
three <- tm_shape(data)+
tm_polygons("GDP_CAPITA",border.col = "black", border.alpha = 0.2, style="quantile")
return(tmap_arrange(one,two,ncol=3,nrow = 1))
}
IDHM <- makeMap("IDHM","IDHM_TV")
DU_URBAN_PERCENTAGE <- makeMap("DU_URBAN_PERCENTAGE","DU_URBAN_PERCENTAGE_TV")
ACTIVE_PERCENTAGE <- makeMap("ACTIVE_PERCENTAGE","ACTIVE_PERCENTAGE_TV")
PLANTED_AREA_PERCENTAGE <- makeMap("PLANTED_AREA_PERCENTAGE","PLANTED_AREA_PERCENTAGE_TV")
Intermediário_Adjacente <- makeMap("Intermediário_Adjacente","Intermediário_Adjacente_TV")
Rural_Adjacente <- makeMap("Rural_Adjacente","Rural_Adjacente_TV")
GVA_AGROPEC_Percentage <- makeMap("GVA_AGROPEC_Percentage","GVA_AGROPEC_Percentage_TV")
GVA_INDUSTRY_Percentage <- makeMap("GVA_AGROPEC_Percentage","GVA_INDUSTRY_Percentage_TV")
GVA_SERVICES_Percentage <- makeMap("GVA_SERVICES_Percentage","GVA_SERVICES_Percentage_TV")
Rural_Remoto <- makeMap("Rural_Remoto","Rural_Remoto_TV")
GVA_PUBLIC_Percentage <- makeMap("GVA_PUBLIC_Percentage","GVA_PUBLIC_Percentage_TV")
TAX_CAPITA <- makeMap("TAX_CAPITA","TAX_CAPITA_TV")
COMP_AGRICULTURE <- makeMap("COMP_AGRICULTURE","COMP_AGRICULTURE_TV")
COMP_INDUSTRY <- makeMap("COMP_INDUSTRY","COMP_INDUSTRY_TV")
COMP_SERVICES <- makeMap("COMP_SERVICES","COMP_SERVICES_TV")
IDHM
makeMap <- function(variable,tscore){
one <- tm_shape(gdp_capita.fixed)+
tm_polygons(variable,border.col = "black", border.alpha = 0.2)
two <- tm_shape(gdp_capita.fixed)+
tm_polygons(tscore,border.col = "black", border.alpha = 0.2, breaks=c(0,1.96,Inf))
three <- tm_shape(data)+
tm_polygons("GDP_CAPITA",border.col = "black", border.alpha = 0.2, style="quantile")
return(tmap_arrange(one,two,three,ncol=3,nrow = 1))
}
IDHM <- makeMap("IDHM","IDHM_TV")
DU_URBAN_PERCENTAGE <- makeMap("DU_URBAN_PERCENTAGE","DU_URBAN_PERCENTAGE_TV")
ACTIVE_PERCENTAGE <- makeMap("ACTIVE_PERCENTAGE","ACTIVE_PERCENTAGE_TV")
PLANTED_AREA_PERCENTAGE <- makeMap("PLANTED_AREA_PERCENTAGE","PLANTED_AREA_PERCENTAGE_TV")
Intermediário_Adjacente <- makeMap("Intermediário_Adjacente","Intermediário_Adjacente_TV")
Rural_Adjacente <- makeMap("Rural_Adjacente","Rural_Adjacente_TV")
GVA_AGROPEC_Percentage <- makeMap("GVA_AGROPEC_Percentage","GVA_AGROPEC_Percentage_TV")
GVA_INDUSTRY_Percentage <- makeMap("GVA_AGROPEC_Percentage","GVA_INDUSTRY_Percentage_TV")
GVA_SERVICES_Percentage <- makeMap("GVA_SERVICES_Percentage","GVA_SERVICES_Percentage_TV")
Rural_Remoto <- makeMap("Rural_Remoto","Rural_Remoto_TV")
GVA_PUBLIC_Percentage <- makeMap("GVA_PUBLIC_Percentage","GVA_PUBLIC_Percentage_TV")
TAX_CAPITA <- makeMap("TAX_CAPITA","TAX_CAPITA_TV")
COMP_AGRICULTURE <- makeMap("COMP_AGRICULTURE","COMP_AGRICULTURE_TV")
COMP_INDUSTRY <- makeMap("COMP_INDUSTRY","COMP_INDUSTRY_TV")
COMP_SERVICES <- makeMap("COMP_SERVICES","COMP_SERVICES_TV")
IDHM
ACTIVE_PERCENTAGE
DU_URBAN_PERCENTAGE
ACTIVE_PERCENTAGE
PLANTED_AREA_PERCENTAGE
Intermediário_Adjacente
Urbano
Rural_Adjacente
GVA_AGROPEC_Percentage
GVA_INDUSTRY_Percentage
GVA_SERVICES_Percentage
Rural_Remoto
GVA_PUBLIC_Percentage
knitr::opts_chunk$set(echo = TRUE, fig.retina = 3, warning = FALSE, message = FALSE)
gdp_capita.fixed <- st_as_sf(gwr.fixed$SDF) %>%
st_transform(crs=4674)
coefficients$Value <- coefficients$Value *1000
coefficients
coefficients$Value <- coefficients$Value *1000
coefficients
bw.fixed <- bw.gwr(formula = GDP_CAPITA.log ~ IDHM  +
DU_URBAN_PERCENTAGE + ACTIVE_PERCENTAGE + PLANTED_AREA_PERCENTAGE + Intermediário_Adjacente+ Rural_Adjacente + GVA_AGROPEC_Percentage+ GVA_INDUSTRY_Percentage + GVA_SERVICES_Percentage + Rural_Remoto+ GVA_PUBLIC_Percentage + TAX_CAPITA + COMP_AGRICULTURE + COMP_INDUSTRY + COMP_SERVICES + COMP_PUBLIC , data = data.sp, approach = "CV", kernel="gaussian", adaptive=FALSE, longlat=TRUE)
knitr::opts_chunk$set(echo = TRUE, fig.retina = 3, warning = FALSE, message = FALSE)
#brazil_cities <- read.csv2("data/aspatial/BRAZIL_CITIES.csv")
brazil_cities <- read_delim(file = "data/aspatial/BRAZIL_CITIES.csv", delim = ";")
metadata <- read.csv2("data/aspatial/Data_Dictionary.csv")
#brazil_cities <- read.csv2("data/aspatial/BRAZIL_CITIES.csv")
brazil_cities <- read_delim(file = "data/aspatial/BRAZIL_CITIES.csv", delim = ";")
metadata <- read.csv2("data/aspatial/Data_Dictionary.csv")
ggplot(data=dependent_variables,
aes_string(x= "GDP_CAPITA")) +
geom_histogram(bins=20,
color="black",
fill="light blue")
